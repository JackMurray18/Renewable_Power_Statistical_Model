---
title: "Sample Solar manipualtion"
author: "Jack Murray"
date: "2/12/2022"
output:
  html_document: default
  word_document: default
---

#library
--------
```{r}
library(tidyverse)
library(lubridate)
library(GGally)
```

#Data read in
-------------
From Combined Solar Data 
```{r readin}
data_files <- list.files("C:/Users/jackm/Desktop/Data Science/Project/Renewable_Power_Statistical_Model/TIDY_SOLAR_DATA")

for(i in 1:length(data_files)) 
{                              
  assign(
    paste0("data", i),                                
    read.csv(paste0("C:/Users/jackm/Desktop/Data Science/Project/Renewable_Power_Statistical_Model/TIDY_SOLAR_DATA/",data_files[i])))
}
```

Create 1 large data frame
```{r}
#all_solar_data <- data1

#for (j in 1:length(data_files))
#{
 # tempdata <- eval(parse(text = paste0("data",i)))
  all_solar_data <- rbind(data1,data2,data3,data4,data5,data6,data7,data8,data9,data10)
#}
```

#Data Explaination
------------------
GHI --> Global horizontal irradiance
        *location influenced measure of solar radiation 
        *GHI = DHI + DNI X cos (z) where z is the solar zenith angle 
        *good measurements for solar panel production 
        
DNI --> Direct normal irradiance
        *measure of the amount of radiation coming in the direction of the sun
        *effected by the cloud cover and particles in the atmosphere

DHI --> Diffuse horizontal irradiance
        *amount of radiation deflected by the atmosphere
        *large values indicate cloud cover and less radiation reaching the ground

#Average Radiation Per Day
--------------------------
```{r averages}
Daily_Solar <- all_solar_data %>%
  group_by(Locations,DATE) %>%
  summarise(daily_DHI = mean(DHI.num),
            daily_DNI = mean(DNI.num),
            daily_GHI = mean(GHI.num),
            daily_Cloud = mean(CloudType.num),
            daily_Wind = mean(WindSpeed.num),
            daily_Cloud = mean(CloudType.num))
 head(Daily_Solar,10)
```
graphs
```{r}
plotdate_rad <- Daily_Solar %>%
  pivot_longer(cols = c(daily_DHI,daily_DNI,daily_GHI,daily_Wind),
               names_to = "Data type")

plotdate_rad %>%
  filter(`Data type` == c("daily_DNI"))%>%
  ggplot(aes(yday(DATE),value))+
  geom_smooth(se = FALSE)+
  geom_bin_2d(alpha=.9)+
  facet_wrap(vars(Locations))+
  labs(x = "Date",
       y = "W/m^2",
       title = "Solar Radiation vs Date Per Location")

plotdate_rad %>%
  filter(`Data type` == c("daily_Wind"))%>%
  ggplot(aes(yday(DATE),value))+
  #geom_point()+
  geom_bin_2d()+
  facet_wrap(vars(Locations))+
  labs(x = "Date",
       y = "MPH",
       title = "Wind Speed vs Date Per Location")
```
Time of the year dramatically effects the the amount of solar radiation and wind speed. 
In the summer, more direct rays from the sun and less cloud cover lead to universal increases in solar radiation. Also, their is a lot more variation in solar radiation in the summer too. Wind is the opposite, summer months have the lowest wind speeds and the least variation.  

The in the winter is cloudier, therefore, more diffusion leads to larger percentage of solar radiation lose in the winter. Decreasing variation as well. Moreover, locations that experience higher wind speeds see a massive increase in average speed and variation in the winter. location with less wind see a reduced increase in winter. 
  
# Distribution of Wind speed per location
-----------------------------------------
```{r}
plotLocation_wind <- Daily_Solar %>%
  select(Locations,daily_Wind)

plotLocation_wind %>%
  ggplot(aes(daily_Wind))+
  geom_histogram(binwidth = 1, color = "Black", alpha = .7)+
  facet_wrap(vars(Locations))+
  labs(x = "Average Wind Speed",
       y = "Count",
       title = "Histogram of Wind Speed Vs Location")
```
Wind speed is highly influenced by location, even in regionally there are dramatic differences. Some locations have less than 2 mph of wind on the majority of days, where as some experience a constant average wind of above 2 or 4 mph. 

#Average RAdtiation per month
-----------------------------
```{r}
monthly <- Daily_Solar %>%
  mutate(mon = month(DATE),
         yr = year(DATE))%>%
  group_by(Locations,yr,mon)%>%
  summarise(mon_DHI = mean(daily_DHI),
            mon_DNI = mean(daily_DNI),
            mon_GHI = mean(daily_GHI))
head(monthly,6)
```
```{r}
plotmonth <- monthly %>%
  select(-mon_DHI)%>%
  pivot_longer(cols = c(mon_GHI,mon_DNI),
               names_to = "Radiation type")
plotmonth %>%
  filter(`Radiation type` == "mon_GHI") %>%
  ggplot(aes(as.character(yr),value))+
  geom_boxplot()+
  #facet_grid(cols = vars(value))+
  labs(x = "Year",
       y = "W/m^2",
       title = "Solar Radiation (GHI) vs Years")

plotmonth %>%
  filter(`Radiation type` == "mon_DNI") %>%
  ggplot(aes(as.character(yr),value))+
  geom_boxplot()+
  #facet_grid(cols = vars(value))+
  labs(x = "Year",
       y = "W/m^2",
       title = "Solar Radiation (DNI) vs Years")
```
Examines the effect time has had on the average solar radiation experienced. In the past 2 decades there has been little increase nor decrease in solar energy received. However, the median solar radiation expediences a sinusoidal pattern with a multiple year periods. 

#Histogram of daily average radiation
-------------------------------------
```{r plot}
#plotdate %>%
#  filter(`Radiation type`=="daily_GHI") %>%
#  ggplot(aes(value))+
#  geom_histogram(binwidth = 40, alpha =.4, color = "blue", fill = "blue")+
#  labs(x = "W/m2",
#       title = "Histogram of Daily Average Radiation")

```
Like wind speed - the solar radiation has a gamma distribution 
  * few days have 0 solar radiation 
  * the most have between 50-150 W/m^2 
  * data is positively skewed 
  
# Longitute and Latitiute Vs Wind and Solar
-------------------------------------------
```{r}
lat_long_rad_wind <- all_solar_data %>%
  mutate(lat_long = paste0(Latitude,":",Longitude)) %>%
  group_by(lat_long) %>%
  summarise(meanGHI = mean(GHI.num),
            sdGHI = sd(GHI.num),
            meanWind = mean(WindSpeed.num),
            sdWind = sd(WindSpeed.num)) %>%
  mutate(Lat = as.numeric(substr(lat_long,1,5)),
         Long = as.numeric(substr(lat_long,7,11)))%>%
  select(-lat_long)
```
```{r}
lat_long_rad_wind %>%
  ggplot(aes(Lat,Long, color = meanGHI, size = sdGHI))+
    geom_point()+
  labs(title = "Solar Radation")

lat_long_rad_wind %>%
  ggplot(aes(Lat,Long, color = meanWind, size = sdWind))+
    geom_point()+
  labs(title = "Wind Speed")
    
```
At least in the northeastern united states, more western and southern locations have higher daily average wind speed and solar radiation, as well as larger variation in daily solar and wind energy experienced. 
Proximity to coast also plays an important factor in average wind speed, since great lake and ocean locations all have higher wind speeds. 

# Wind Speed and Solar Radiation Vs Cloudcover
----------------------------------------------
```{r}
dailycloud <- Daily_Solar %>%
  mutate(mon = month(DATE),
         yr = year(DATE))%>%
  group_by(Locations,mon,yr)%>%
  summarise(mon.wind = mean(daily_Wind),
            mon.GHI = mean(daily_GHI),
            mon.cloud = mean(daily_Cloud))

dailycloud%>%
  ggplot(aes(x = mon.cloud, y=mon.wind, color = as.character(Locations)))+
    geom_smooth(se = FALSE)+
    labs(x = "cloud cover", y = "Wind Speed", title = "Wind Speed vs Cloud Cover")

dailycloud%>%
  ggplot(aes(x = mon.cloud, y=mon.GHI, color = as.character(Locations)))+
    geom_smooth(se = FALSE)+
    labs(x = "cloud cover", y = "GHI W/m^2", title = "Radiation vs Cloud Cover")

  
```
Since inclement whether is cloudier, and will lead to higher winds and less sunlight reaching the ground, it is possible the the amount of cloud cover is related to wind speed and solar radiation. 
  * Solar Radiation - as expected, with more clouds, there is a strong negative relationship between     the amount of clouds and solar radiation. Locations with regular cloud cover will have less         solar radiation.
  * Wind Speed - wind speed shows little correlation with cloud cover. Some location have a slight     positive relationship. Overall cloud cover is un related to wind speed if compared to               geographical features. 
# Pair Plots 
------------
```{r}
locationCOL_solar <- Daily_Solar %>%
  select(DATE,daily_DNI,Locations)%>%
  pivot_wider(names_from = Locations,
              values_from = daily_DNI)%>%
  select(-DATE)%>%
  slice_sample(n = 420)

ggpairs(locationCOL_solar)
        
```
In the northeast, location influences the amount of solar radiation. Some locations' solar radiation is heavily positively related to other location's. Therefore, if one experiences high solar radiation, then the other will too. Such as, 1272597 and 1270899.
However, certain locations have less of a relationship, and the solar radiation between these locations do not effect each other. such as 1021900 and 1412499. 
```{r}
locationCOL_wind <- Daily_Solar %>%
  select(DATE,daily_Wind,Locations)%>%
  pivot_wider(names_from = Locations,
              values_from = daily_Wind)%>%
  select(-DATE)%>%
  slice_sample(n = 420)

ggpairs(locationCOL_wind)
        
```
Similarly to the solar radiation pairs plot, location influences the wind speed. Also some locations are highly influenced by anther's wind speed. For example, if the wind is low in 1234067, it will likely also be low in 1272597. The opposite is true of some locations as well, like 1412499 and 1021900 are barely influenced by each other at all. 
